
openapi: 3.0.0
info:
  title: ITEG Management API
  version: 1.0.0
  description: API for managing users like admin, superadmin, and faculty.

security:
  - bearerAuth: []

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    User:
      type: object
      properties:
        _id:
          type: string
          example: "662b18b6c3eabc00123f5678"
        profileImage:
          type: string
          example: "https://example.com/profile.jpg"
        position:
          type: string
          example: "Developer"
        name:
          type: string
          example: "John Doe"
        email:
          type: string
          example: "johndoe@example.com"
        mobileNo:
          type: string
          example: "9876543210"
        adharCard:
          type: string
          example: "123456789012"
        password:
          type: string
          example: "$2b$10$somethinghashed"   # Password will be hashed
        role:
          type: string
          example: "admin"
        department:
          type: string
          example: "IT"
        refreshToken:
          type: string
          example: "some-refresh-token"
        isActive:
          type: boolean
          example: true
        createdAt:
          type: string
          format: date-time
          example: "2024-04-29T08:00:00.000Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-04-29T08:30:00.000Z"
    Admission:
      type: object
      required:
        - prkey
        - firstName
        - lastName
        - fatherName
        - studentMobile
        - parentMobile
        - gender
        - dob
        - aadharCard
        - address
        - stream
        - course
        - category
        - subject12
        - year12
        - percent12
        - percent10
      properties:
        prkey:
          type: string
          example: PR123456
        firstName:
          type: string
          example: John
        lastName:
          type: string
          example: Doe
        fatherName:
          type: string
          example: Richard Doe
        email:
          type: string
          format: email
          example: john.doe@example.com
        studentMobile:
          type: string
          example: "9876543210"
        parentMobile:
          type: string
          example: "9123456780"
        gender:
          type: string
          example: Male
        dob:
          type: string
          format: date
          example: 2000-01-01
        aadharCard:
          type: string
          example: "123456789012"
        address:
          type: string
          example: "123 Main St, City, State"
        stream:
          type: string
          example: Science
        course:
          type: string
          example: B.Sc
        category:
          type: string
          example: General
        subject12:
          type: string
          example: Physics
        year12:
          type: string
          example: "2018"
        percent12:
          type: string
          example: "85%"
        percent10:
          type: string
          example: "85%"
        itegInterviewFlag:
          type: boolean
          example: false
        admissionStatus:
          type: boolean
          example: false
        admissionDate:
          type: string
          format: date
          example: 2025-04-25
        interviewStage:
          type: string
          enum:
            - Registered
            - Test Scheduled
            - Test not Attempted
            - Test Completed
            - First Interview Scheduled
            - First Interview Passed
            - Second Interview Scheduled
            - Second Interview Passed
            - ITEG Interview Completed
          example: Registered
        onlineTest:
          type: object
          properties:
            date:
              type: string
              format: date
              example: 2025-04-20
            testLink:
              type: string
              example: http://example.com/test
            result:
              type: string
              enum: [Pass, Fail, Pending, Not Attempted]
              example: Pending
        interviews:
          type: array
          items:
            type: object
            properties:
              round:
                type: string
                enum: [First, Second]
                example: First
              assignment:
                type: string
                example: "Assignment details here"
              attemptNo:
                type: integer
                example: 1
              communication:
                type: number
                example: 5
              confidence:
                type: number
                example: 4
              goal:
                type: number
                example: 3
              subjectKnowlage:
                type: number
                example: 4
              assignmentMarks:
                type: number
                example: 4
              sincerity:
                type: number
                example: 4
              maths:
                type: number
                example: 4
              reasoning:
                type: number
                example: 4
              created_by:
                type: string
                example: "faculty"
              marks:
                type: number
                example: 85
              remark:
                type: string
                example: Good performance
              date:
                type: string
                format: date
                example: 2025-04-22
              result:
                type: string
                enum: [Pass, Fail, Pending]
                example: Pass
        scheduledInterview:
          type: object
          properties:
            date:
              type: string
              format: date
              example: 2025-04-25
            round:
              type: string
              enum: [First, Second]
              example: First
            isScheduled:
              type: boolean
              example: true
    Admittedstudent:
      Level:
      type: object
      properties:
        levelNo:
          type: string
          example: "1"
        noOfAttempts:
          type: integer
          default: 0
        Topic:
          type: string
          example: "Java"
        marks:
          type: number
          default: 0
        remark:
          type: string
        date:
          type: string
          format: date
        result:
          type: string
          enum: [Pass, Fail, Pending]
          default: Pending

    PlacedInfo:
      type: object
      properties:
        companyName:
          type: string
        salary:
          type: number
        location:
          type: string

    InterviewRecord:
      type: object
      properties:
        companyName:
          type: string
        interviewDate:
          type: string
          format: date
        remark:
          type: string
        result:
          type: string
          enum: [Selected, Rejected, Pending]
          default: Pending
        location:
          type: string
        jobProfile:
          type: string

    AdmittedStudent:
      type: object
      required:
        - admissionRef
        - fullName
        - prkey
        - stream
        - course
        - fatherName
        - mobileNo
        - address
        - track
        - village
      properties:
        admissionRef:
          type: string
          format: uuid
        fullName:
          type: string
        prkey:
          type: string
        stream:
          type: string
        course:
          type: string
        fatherName:
          type: string
        mobileNo:
          type: string
        email:
          type: string
        address:
          type: string
        track:
          type: string
        village:
          type: string
        level:
          type: array
          items:
            $ref: '#/components/schemas/Level'
        techno:
          type: string
        attendancePercentage:
          type: number
          minimum: 0
          maximum: 100
        placedInfo:
          $ref: '#/components/schemas/PlacedInfo'
        permissionRequired:
          type: boolean
          default: false
        interviewRecord:
          type: array
          items:
            $ref: '#/components/schemas/InterviewRecord'
        readinessStatus:
          type: string
          enum: [Ready, Not Ready]
          default: Not Ready
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

paths:
  /api/user/signup:
    post:
      summary: Register a new user (admin/superadmin/faculty)
      tags:
        - Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - email
                - password
                - mobileNo
                - adharCard
                - department
                - position
                - role
              properties:
                name:
                  type: string
                  example: John Doe
                profileImage:
                  type: string
                  example: https://example.com/profile.jpg
                email:
                  type: string
                  format: email
                  example: johndoe@example.com
                password:
                  type: string
                  format: password
                  example: Password123
                mobileNo:
                  type: string
                  example: "9876543210"
                adharCard:
                  type: string
                  example: "123456789012"
                department:
                  type: string
                  example: Computer Science
                position:
                  type: string
                  example: Assistant Professor
                role:
                  type: string
                  enum: [admin, superadmin, faculty]
                  example: faculty
      responses:
        '201':
          description: User created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Faculty created successfully!
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: 644a99999f73e02bcd123456
                      name:
                        type: string
                        example: John Doe
                      email:
                        type: string
                        example: johndoe@example.com
                      mobileNo:
                        type: string
                        example: "9876543210"
                      role:
                        type: string
                        example: faculty
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

        '400':
          description: User already exists or invalid role
        '500':
          description: Server Error

  /api/user/login:
    post:
      summary: Login a user
      tags:
        - Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: admin@ssism.org
                password:
                  type: string
                  format: password
                  example: admin@123
      responses:
        '200':
          description: Successful login
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Login successful
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: 644a99999f73e02bcd123456
                      name:
                        type: string
                        example: John Doe
                      email:
                        type: string
                        example: johndoe@example.com
                      role:
                        type: string
                        example: faculty
                      position:
                        type: string
                        example: Assistant Professor
                      department:
                        type: string
                        example: Computer Science

        '401':
          description: Invalid email or password
        '500':
          description: Server error

  /api/user/update/{id}:
    patch:
      tags:
        - Auth
      summary: Update user fields
      description: Update fields like position, role, department, isActive for a user by their ID.
      parameters:
        - name: id
          in: path
          required: true
          description: User ID to update
          schema:
            type: string

            properties:
                position:
                  type: string
                  example: "Senior Developer"
                role:
                  type: string
                  example: "admin"
                department:
                  type: string
                  example: "IT"
                isActive:
                  type: boolean
                  example: true
      responses:
        200:
          description: User updated successfully
              required:
                - email
                - otp
              properties:
                email:
                  type: string
                  example: user@example.com
                otp:
                  type: string
                  example: "123456"

  /api/user/update/{id}:
    patch:
      patch:
      summary: Update selected fields of a user
      tags:
        - Auth
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            example: 66347f96f30bfa9012c0df25
          description: MongoDB ObjectId of the user to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: John Doe
                position:
                  type: string
                  example: Assistant Professor
                role:
                  type: string
                  enum: [admin, superadmin, faculty]
                  example: faculty
                department:
                  type: string
                  example: Computer Science
                isActive:
                  type: boolean
                  example: true
      responses:
        '200':
          description: User updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: User updated successfully
                  user:
                    $ref: '#/components/schemas/User'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: User not found
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Server error
                  error:
                    type: string



  /api/user/otp/send:
    post:
      summary: Send OTP to user email for login
      tags:
        - Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  example: anees774883@gmail.com
      responses:
        '200':
          description: OTP sent to registered email
        '400':
          description: Email is required
        '404':
          description: User with this email does not exist
        '429':
          description: Maximum OTP request limit exceeded
        '500':
          description: Internal Server Error

  /api/user/otp/verify:
    post:
      summary: Verify OTP and login user
      tags:
        - Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - otp
              properties:
                email:
                  type: string
                  example: anees774883@gmail.com
                otp:
                  type: string
                  example: "123456"
              
      responses:
        '200':
          description: OTP verified and login success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User updated successfully"
                  user:
                    $ref: '#/components/schemas/User'
        400:
          description: Invalid request data
        404:
          description: User not found
        500:
          description: Server error

  /api/admission/students/webhook/register:
    post:
      summary: Add or update student admission data
      tags:
        - Admission Process
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - prkey
                - firstName
                - lastName
                - fatherName
                - studentMobile
                - parentMobile
                - gender
                - dob
                - aadharCard
                - address
                - stream
                - course
                - category
                - subject12
                - year12
                - percent12
                - percent10
              properties:
                prkey:
                  type: string
                  example: "SS123456"
                firstName:
                  type: string
                  example: "Rahul"
                lastName:
                  type: string
                  example: "Sharma"
                fatherName:
                  type: string
                  example: "Mahesh Sharma"
                studentMobile:
                  type: string
                  pattern: "^[0-9]{10}$"
                  example: "9876543210"
                parentMobile:
                  type: string
                  pattern: "^[0-9]{10}$"
                  example: "9876543211"
                gender:
                  type: string
                  enum: [Male, Female, Other]
                  example: "Male"
                dob:
                  type: string
                  format: date
                  example: "2005-08-15"
                aadharCard:
                  type: string
                  pattern: "^[0-9]{12}$"
                  example: "123412341234"
                address:
                  type: string
                  example: "123, ABC Nagar, Indore"
                track:
                  type: string
                  example: "harda"
                email:
                  type: string
                  format: email
                  example: "ssism.org"
                village:
                  type: string
                  example: "Harda"
                stream:
                  type: string
                  example: "Science"
                course:
                  type: string
                  example: "B.Sc"
                category:
                  type: string
                  example: "General"
                subject12:
                  type: string
                  example: "PCM"
                year12:
                  type: string
                  example: "2022"
                percent12:
                  type: string
                  example: "85%"
                percent10:
                  type: string
                  example: "90%"
      responses:
        '201':
          description: Student admission initiated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Student admission initiated
                  data:
                    $ref: '#/components/schemas/Admission'
        '200':
          description: Student already registered, data updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Student already registered
                  data:
                    $ref: '#/components/schemas/Admission'
        '400':
          description: Missing or invalid input
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Missing field: firstName
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Error adding admission
                  error:
                    type: string


  /api/admission/students/create_interview/{id}:
    post:
      tags:
        - Admission Process
      summary: Add an interview round for a student
      description: Adds a new interview attempt for a given admission ID, enforcing interview rules like round order and maximum failed attempts.
      parameters:
        - name: id
          in: path
          required: true
          description: The ID of the student in the admission process
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - round
              properties:
                round:
                  type: string
                  description: Interview round name (e.g., First, Second)
                  example: "First"
                assignment:
                  type: string
                  description: Assignment details for the interview
                  example: "Assignment details here"
                communication:
                  type: Number
                  description: Communication mode (e.g., Zoom, Google Meet)
                  example: 7
                confidence:
                  type: Number
                  description: Confidence level of the candidate
                  example: 5
                goal:
                  type: Number
                  description: Interview goal (e.g., Technical, HR)
                  example: 3
                subjectKnowlage:
                 type: Number
                 description: Subject of the interview
                 example: 5
                assignmentMarks:
                  type: Number
                  description: Technical skills assessed in the interview
                  example: 5
                sincerity:
                 type: Number
                 description: Sincerity level of the candidate
                 example: 5
                maths:
                  type: Number
                  description: Mathematics skills assessed in the interview
                  example: 5
                reasoning:
                 type: Number
                 description: Reasoning skills assessed in the interview
                 example: 5
                marks:
                  type: integer
                  description: Marks obtained in the interview
                  example: 85
                remark:
                  type: string
                  description: Interviewer's remark
                  example: "Strong technical skills"
                created_by:
                  type: string
                  description: The person who created the interview record
                  example: "faculty"
                date:
                  type: string
                  format: date-time
                  description: Date of interview
                  example: "2025-04-29T10:00:00Z"
                result:
                  type: string
                  description: Result of the interview
                  enum: [Pass, Fail, Pending]
                  example: "Pass"
      responses:
        '201':
          description: Interview added successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Interview round added successfully
                  student:
                    $ref: '#/components/schemas/Admission'
        '400':
          description: Bad request due to validation failure or logic rejection
        '404':
          description: Student not found
        '500':
          description: Server error

  /api/user/logout:
    post:
      summary: Logout user and remove refresh token
      tags:
        - Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - _id
              properties:
                _id:
                  type: string
                  example: 644a99999f73e02bcd123456
             
      responses:
        '200':
          description: Logged out successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Interview round added successfully
                  student:
                    $ref: './schemas/Admission'
        '400':
          description: Bad request due to validation failure or logic rejection
                  message:
                    type: string
                    example: Logged out successfully, refresh token removed
        '400':
          description: User ID is required
        '404':
          description: User not found
        '500':
          description: Server error

  /api/admission/students/get_interviews/{id}:
    get:
      tags:
        - Admission Process
      description: Get all interviews for a student
      summary: Get student interviews
      parameters:
        - name: id
          in: path
          required: true
          description: Student ID
          schema:
            type: string
      responses:
        200:
          description: Interviews retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean, example: true }
                  interviews: 
                    type: array
                    items:
                      type: object
                      properties:
                        round: { type: string, example: "First" }
                        result: { type: string, enum: ["Pass", "Fail", "Pending"], example: "Pass" }
        404:
          description: Student not found
        500:
          description: Server error

  /api/admission/students/getall:
    get:
      tags:
        - Admission Process
      summary: Get all students
      responses:
        200:
          description: List of all students
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: './schemas/Admission'
        500:
          description: Server error


  /api/admission/students/{id}:
    get:
      tags:
        - Admission Process
      summary: Get student by ID
      description: Retrieve a student's admission record by their ID
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the student
          schema:
            type: string
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Student fetched successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Student fetched successfully
                  data:
                    $ref: '#/components/schemas/Admission'
        '404':
          description: Student not found
        '500':
          description: Server Error

  
  /api/admission/students/webhook/admission_flag_update:
    post:
      summary: Update admission status and create admitted student record
      tags:
         - Admitted Student
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - prkey
                - admissionStatus
              properties:
                prkey:
                  type: string
                  example: "SS123456"
                admissionStatus:
                  type: boolean
                  example: true
      responses:
        '201':
          description: Student admission status updated and admitted student created
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Student admitted"
                  data:
                    $ref:  '#/components/schemas/Admission'
        '200':
          description: Admission status updated but student not admitted (e.g., status false)
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Student not cleared or not found."
        '400':
          description: Bad request - missing fields or status false
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Both prkey and admissionStatus are required"
        '404':
          description: Student with prkey not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Student not found with the provided prkey"
        '500':
          description: Server error during update or creation
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Server error"
                  error:
                    type: string

  # /api/admission/students/update_interview_flag/{studentId}:
  #   put:
  #     summary: Update ITEG interview flag and notify central system
  #     tags:
  #        - Admission Process
  #     parameters:
  #       - in: path
  #         name: studentId
  #         required: true
  #         schema:
  #           type: string
  #           example: "6811f74b6a40d2524ec7d870"
  #         description: MongoDB ObjectId of the student to update
  #     responses:
  #       '200':
  #         description: Interview flag updated and sent to central system
  #         content:
  #           application/json:
  #             schema:
  #               type: object
  #               properties:
  #                 message:
  #                   type: string
  #                   example: Interview flag updated and sent to central
  #                 centralResponse:
  #                   type: object
  #                   description: Response from the central system
  #       '400':
  #         description: Missing or invalid student ID
  #         content:
  #           application/json:
  #             schema:
  #               type: object
  #               properties:
  #                 message:
  #                   type: string
  #                   example: Student ID is required
  #       '404':
  #         description: Student not found
  #         content:
  #           application/json:
  #             schema:
  #               type: object
  #               properties:
  #                 message:
  #                   type: string
  #                   example: Student not found
  #       '500':
  #         description: Server or central system error
  #         content:
  #           application/json:
  #             schema:
  #               type: object
  #               properties:
  #                 message:
  #                   type: string
  #                   example: Server error
  #                 error:
  #                   type: string
  #                   example: Failed to connect to central system


  /api/admitted/students/getall:
    get:
      summary: Get all admitted students
      description: Fetches a list of all admitted students.
      tags:
        - Admitted Student
      responses:
        '200':
          description: List of admitted students
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AdmittedStudent'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Server error

  /api/admitted/students/{id}:
    get:
      summary: Get student by ID
      description: Fetches a single admitted student's details using their unique MongoDB ObjectId.
      tags:
        - Admitted Student
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the admitted student
          schema:
            type: string
      responses:
        '200':
          description: Student found successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdmittedStudent'
        '404':
          description: Student not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Student not found
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  error:
                    type: string



  /api/admitted/students/getall:
    get:
      summary: Get all admitted students
      description: Fetches a list of all admitted students.
      tags:
        - Admitted Student
      responses:
        '200':
          description: List of admitted students
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AdmittedStudent'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Server error

  /api/admitted/students/{id}:
    get:
      summary: Get student by ID
      description: Fetches a single admitted student's details using their unique MongoDB ObjectId.
      tags:
        - Admitted Student
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the admitted student
          schema:
            type: string
      responses:
        '200':
          description: Student found successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AdmittedStudent'
        '404':
          description: Student not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Student not found
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  error:
                    type: string
  

  /api/admitted/students/create_level/{id}:
    post:
      summary: Add new level attempt for a student
      description: Automatically determines and adds the next level based on student's previous progress.
      tags:
        - Admitted Student
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: ID of the admitted student
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                Theoretical_Marks:
                  type: number
                  example: 30
                Practical_Marks:
                  type: number
                  example: 25
                Communication_Marks:
                  type: number
                  example: 15
                marks:
                  type: number
                  example: 70
                remark:
                  type: string
                  example: Good performance
                date:
                  type: string
                  format: date-time
                  example: "2025-05-01T10:00:00Z"
                result:
                  type: string
                  enum: [Pass, Fail, Pending]
                  example: Pass
      responses:
        '201':
          description: Level attempt added successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  student:
                    $ref: '#/components/schemas/Admission/Level'
        '400':
          description: Bad Request (e.g., all levels completed or duplicate passed level)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '404':
          description: Student not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  error:
                    type: string



  /api/admitted/students/get_levels/{id}:
    get:
      summary: Get all interview levels of a student
      description: Retrieve all interview levels for a student by their ID.
      tags:
        - Admitted Student
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the student
          schema:
            type: string
      responses:
        '200':
          description: List of interview levels
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    levelNo:
                      type: string
                      example: "1A"
                    noOfAttempts:
                      type: integer
                      example: 1
                    Theoretical_Marks:
                      type: number
                      example: 30
                    Practical_Marks:
                      type: number
                      example: 25
                    Communication_Marks:
                      type: number
                      example: 15
                    marks:
                      type: number
                      example: 70
                    remark:
                      type: string
                      example: "Good performance"
                    date:
                      type: string
                      format: date-time
                      example: "2025-05-01T10:00:00Z"
                    result:
                      type: string
                      example: "Pass"
        '404':
          description: Student or levels not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Student not found"
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Server Error"
                  error:
                    type: string



  /api/admitted/students/level/{levelNo}:
    get:
      summary: Get students by their latest level number
      tags:
        - Admitted Student
      parameters:
        - in: path
          name: levelNo
          required: true
          schema:
            type: string
          description: Level number to filter students by their latest level
      responses:
        '200':
          description: List of students with the specified latest level
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AdmittedStudent'
        '404':
          description: No students found for this level
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: No students found for this level
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  error:
                    type: object

 
                    type: string


  /api/admission/students/webhook/update-admitted-student:
    patch:
      summary: Update admitted student by primary key (prkey)
      tags:
        - Admitted Student
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - prkey
              properties:
                prkey:
                  type: string
                  example: "SS123457"
                firstName:
                  type: string
                  example: "UpdatedFirstName"
                lastName:
                  type: string
                  example: "UpdatedLastName"
                fatherName:
                  type: string
                  example: "UpdatedFather"
                email:
                  type: string
                  format: email
                  example: "updated.email@example.com"
                studentMobile:
                  type: string
                  example: "9876543210"
                parentMobile:
                  type: string
                  example: "9123456780"
                gender:
                  type: string
                  enum: [Male, Female, Other]
                  example: "Male"
                dob:
                  type: string
                  format: date
                  example: "2006-07-20"
                aadharCard:
                  type: string
                  example: "1234-5678-9012"
                village:
                  type: string
                  example: "UpdatedVillage"
                track:
                  type: string
                  example: "Science"
                category:
                  type: string
                  example: "OBC"
                stream:
                  type: string
                  example: "PCM"
                course:
                  type: string
                  example: "B.Sc"
                subject12:
                  type: string
                  example: "Physics, Chemistry, Math"
                year12:
                  type: string
                  example: "2024"
                percent12:
                  type: string
                  example: "85.60"
                percent10:
                  type: string
                  example: "88.40"
                address:
                  type: string
                  example: "123 New Street, Town, State"
      responses:
        "200":
          description: Admitted student updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Admitted student updated successfully
                  data:
                    $ref: '#/components/schemas/AdmittedStudent'
        "400":
          description: Missing or invalid prkey
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Admission ID (prkey) is required
        "404":
          description: Admitted student not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Admitted student not found
        "500":
          description: Server error during update
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Update failed
                  error:
                    type: string
                    example: Detailed error message

  /api/user/refresh_token:
    post:
      summary: Refresh Access Token using valid Refresh Token
      tags:
        - Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refreshToken
              properties:
                refreshToken:
                  type: string
                  example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

      responses:
        '200':
          description: New access token issued successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Access token refreshed"
                  accessToken:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        '401':
          description: Refresh token not provided
        '403':
          description: Invalid or expired refresh token
        '500':
          description: Server error 

  /api/user/forgot_password:
    post:
      summary: Send reset password link to user's email
      tags:
        - Auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  example: aneeskhan@ssism.org
      responses:
        '200':
          description: Reset password link sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Reset link sent to your email.
        '404':
          description: User not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: User not found
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Server error
                  error:
                    type: string
                    example: Internal server error 

  /api/user/reset_password/{token}:
    post:
      summary: Reset password using token
      tags:
        - Auth
      parameters:
        - in: path
          name: token
          required: true
          schema:
            type: string
          description: JWT token received via reset password email
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - newPassword
                - confirmPassword
              properties:
                newPassword:
                  type: string
                  format: password
                  example: NewPass@123
                confirmPassword:
                  type: string
                  format: password
                  example: NewPass@123
      responses:
        '200':
          description: Password reset successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Password successfully reset
        '400':
          description: Invalid token, expired token, or bad input
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Invalid or expired token
        '500':
          description: Internal server error

  /api/user/google/callback:
    get:
      summary: Google OAuth callback handler
      tags:
        - Auth
      description: Google redirects here after login. This route verifies the user and issues access and refresh tokens. Only SSISM domain users are allowed.
      responses:
        '302':
          description: Redirect to frontend with JWT token and refresh token
        '403':
          description: Forbidden - Non SSISM email used
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Only institutional emails (@ssism.org) are allowed to login.
        '500':
          description: Internal server error

  /api/admitted/students/permission_students:
    get:
      summary: Get all permission-granted students
      description: Returns a list of students who have permission details assigned (non-null).
      tags:
        - Admitted Student
      security:
        - bearerAuth: []  #Requires JWT token
      responses:
        '200':
          description: List of students with permission granted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  count:
                    type: integer
                    example: 3
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/AdmittedStudent'
        '401':
          description: Unauthorized - Missing or invalid token
        '403':
          description: Forbidden - You are not allowed to access this route
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Server Error

  /api/admitted/students/update_permission_student/{studentId}:
    patch:
      summary: Update permission details of a student
      description: Updates the permission details of an admitted student using their student ID. Only accessible by Super Admin, Admin, or Faculty.
      tags:
        - Admitted Student
      parameters:
        - name: studentId
          in: path
          required: true
          description: MongoDB ID of the student
          schema:
            type: string
            example: 664f3b7c2390ab0ef2d9a0e4
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - imageURL
                - approved_by
              properties:
                imageURL:
                  type: string
                  description: Base64 encoded image string (format: data:image/jpeg;base64,...)
                  example: data:image/jpeg;base64,/9j/4AAQSkZJRgABAQE...
                remark:
                  type: string
                  description: Optional remark for permission approval
                  example: Approved due to special request
                approved_by:
                  type: string
                  description: Role of the approver
                  enum: [super admin, admin, faculty]
                  example: admin
      responses:
        '200':
          description: Permission updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Permission updated successfully
                  student:
                    $ref: '#/components/schemas/AdmittedStudent'
        '400':
          description: Validation or role error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Invalid image format. Must be Base64 string.
        '404':
          description: Student not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Student not found
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Server Error

  /api/admitted/students/update-placement/{id}:
    put:
      summary: Update placement information for a student
      description: |
        Allows only **superadmin** and **admin** to update the placement information 
        (even if student has not cleared Level 2C).  
        Placement info includes company name, salary, location, and job profile.
      tags:
        - Admitted Student
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: MongoDB ObjectId of the admitted student
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                companyName:
                  type: string
                  example: Infosys
                salary:
                  type: number
                  example: 400000
                location:
                  type: string
                  example: Pune
                jobProfile:
                  type: string
                  example: Software Developer
              required:
                - companyName
                - salary
                - location
                - jobProfile
      responses:
        '200':
          description: Placement updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Placement information updated successfully.
                  placedInfo:
                    type: object
                    properties:
                      companyName:
                        type: string
                        example: Infosys
                      salary:
                        type: number
                        example: 400000
                      location:
                        type: string
                        example: Pune
                      jobProfile:
                        type: string
                        example: Software Developer
        '500':
          description: Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Server Error



  /api/admitted/students/companies/{companyName}:
    get:
      summary: Get company by name
      tags:
        - Placement
      parameters:
        - name: companyName
          in: path
          required: true
          schema:
            type: string
            example: "TechCorp Solutions"
      responses:
        '200':
          description: Company details
        '404':
          description: Company not found
        '500':
          description: Server error

  /api/user/get/{id}:
    get:
      summary: Get user details by ID
      tags:
        - Auth
      parameters:
        - name: id
          in: path
          required: true
          description: MongoDB ID of the user
          schema:
            type: string
      responses:
        '200':
          description: User fetched successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: 664e29c535a98a3c5c5e25e1
                      name:
                        type: string
                        example: Anees Khan
                      email:
                        type: string
                        example: anees@ssism.org
                      role:
                        type: string
                        example: admin
                      mobileNo:
                        type: string
                        example: "9999999999"
                      department:
                        type: string
                        example: IT
                      position:
                        type: string
                        example: HOD
        '404':
          description: User not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: User not found
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Server error
                  error:
                    type: string
                    example: Error stack or message


  /api/admitted/students/Ready_Students:
    get:
      summary: Get all admitted students who are ready
      tags:
        - Placement
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Successfully fetched all ready students
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Ready students fetched successfully.
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/AdmittedStudent'
        '404':
          description: No ready students found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: No students found with readinessStatus 'Ready'.
        '500':
          description: Server error while fetching students
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Failed to fetch ready students.
                  error:
                    type: string



  /api/admitted/students/interviews/{studentId}:
    post:
      summary: Schedule a placement interview for a student
      tags:
        - Placement Interviews
      parameters:
        - in: path
          name: studentId
          required: true
          schema:
            type: string
          description: The MongoDB ObjectId of the admitted student
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - companyName
                - jobProfile
                - scheduleDate
              properties:
                companyName:
                  type: string
                  example: "TCS"
                jobProfile:
                  type: string
                  example: "Software Engineer"
                location:
                  type: string
                  example: "Bengaluru"
                status:
                  type: string
                  enum: ["Scheduled", "Rescheduled", "Ongoing", "Selected", "RejectedByStudent", "RejectedByCompany"]
                  example: "Scheduled"
                scheduleDate:
                  type: string
                  format: date-time
                  example: "2025-08-15T09:30:00Z"
                rounds:
                  type: array
                  items:
                    type: object
                    required:
                      - roundName
                      - date
                    properties:
                      roundName:
                        type: string
                        example: "Technical Round"
                      date:
                        type: string
                        format: date-time
                        example: "2025-08-15T09:30:00Z"
                      mode:
                        type: string
                        enum: ["Online", "Offline", "Telephonic"]
                        example: "Online"
                      feedback:
                        type: string
                        example: "Strong problem-solving skills"
                      result:
                        type: string
                        enum: ["Passed", "Failed", "Pending"]
                        example: "Pending"
      responses:
        "201":
          description: Placement interview scheduled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Placement interview scheduled successfully
                  interview:
                    $ref: '#/components/schemas/InterviewRecord'
        "400":
          description: Missing required fields
        "404":
          description: Student not found
        "500":
          description: Server error

    # post:
    #   tags:
    #     - Placement
    #   summary: Add interview record for a student
    #   description: Add a new interview record to a student's profile. The student must have readinessStatus = "Ready".
    #   parameters:
    #     - name: id
    #       in: path
    #       required: true
    #       description: MongoDB ObjectId of the student
    #       schema:
    #         type: string
    #         example: 665f6aaf4f55e5aaee6a1234
    #   requestBody:
    #     required: true
    #     content:
    #       application/json:
    #         schema:
    #           type: object
    #           required:
    #             - companyName
    #             - interviewDate
    #             - location
    #             - jobProfile
    #           properties:
    #             companyName:
    #               type: string
    #               example: Infosys
    #             interviewDate:
    #               type: string
    #               format: date
    #               example: 2025-06-15
    #             remark:
    #               type: string
    #               example: "Performed well in technical round"
    #             result:
    #               type: string
    #               enum: [Selected, Rejected, Pending]
    #               default: Pending
    #               example: Pending
    #             location:
    #               type: string
    #               example: Pune
    #             jobProfile:
    #               type: string
    #               example: Software Engineer Intern
    #   responses:
    #     '201':
    #       description: Interview record added successfully
    #       content:
    #         application/json:
    #           schema:
    #             type: object
    #             properties:
    #               success:
    #                 type: boolean
    #                 example: true
    #               message:
    #                 type: string
    #                 example: Interview record added
    #               data:
    #                 type: array
    #                 items:
    #                   $ref: '#/components/schemas/InterviewRecord'
    #     '400':
    #       description: Student is not eligible (readinessStatus is not "Ready")
    #       content:
    #         application/json:
    #           schema:
    #             type: object
    #             properties:
    #               success:
    #                 type: boolean
    #                 example: false
    #               message:
    #                 type: string
    #                 example: Student is not eligible for interview. Status: Not Ready
    #     '404':
    #       description: Student not found
    #     '500':
    #       description: Server error




  /api/admitted/students/update/interviews/{studentId}/{interviewId}:
    patch:
      tags:
        - Placement
      summary: Update interview record for a student
      description: Update the `remark` and/or `result` of a specific interview in a student's interview record.
      parameters:
        - name: studentId
          in: path
          required: true
          description: MongoDB ObjectId of the student
          schema:
            type: string
            example: 665f6aaf4f55e5aaee6a1234
        - name: interviewId
          in: path
          required: true
          description: MongoDB ObjectId of the interview record
          schema:
            type: string
            example: 682c08b600d3e1245aa7cd71
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                remark:
                  type: string
                  example: "Good communication skills and confidence"
                result:
                  type: string
                  enum: [Selected, Rejected, Pending]
                  example: "Selected"
      responses:
        '200':
          description: Interview record updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Interview record updated successfully
                  data:
                    type: object
                    properties:
                      _id:
                        type: string
                        example: 682c08b600d3e1245aa7cd71
                      companyName:
                        type: string
                        example: TCS
                      interviewDate:
                        type: string
                        format: date
                        example: 2025-06-10
                      remark:
                        type: string
                        example: Good communication skills and confidence
                      result:
                        type: string
                        example: Selected
        '400':
          description: Invalid input (e.g. missing result or remark)
        '404':
          description: Student or interview record not found
        '500':
          description: Server error


  /api/admitted/students/upload_Resume_Base64:
    post:
      summary: Upload student resume as Base64
      tags:
        - Placement
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - studentId
                - fileName
                - fileData
              properties:
                studentId:
                  type: string
                  description: MongoDB ObjectId of the student
                  example: "60d9f8c19c2f4f0021a7b123"
                fileName:
                  type: string
                  description: Name of the file (e.g. "resume.pdf")
                  example: "resume.pdf"
                fileData:
                  type: string
                  description: Base64 encoded file data (with or without Data URI prefix)
                  example: "JVBERi0xLjQKJfbk..."
      responses:
        '200':
          description: Resume uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Resume uploaded successfully"
                  resumeURL:
                    type: string
                    example: "https://res.cloudinary.com/demo/raw/upload/v1623762345/student-resumes/resume.pdf"
        '400':
          description: Missing parameters or bad request
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Missing studentId, fileName, or fileData"
        '404':
          description: Student not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Student not found"
        '500':
          description: Server error during upload
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Server Error"
                  error:
                    type: string
                    example: "Error details here"

  /api/admitted/students/placement-post:
    post:
      summary: Create placement post data
      tags:
        - Placement
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - studentId
                - position
                - companyName
                - headOffice
              properties:
                studentId:
                  type: string
                  description: MongoDB ObjectId of the student
                  example: "6899cb184c53588ffc98bc1f"
                position:
                  type: string
                  description: Job position in the company
                  example: "Software Developer"
                companyName:
                  type: string
                  description: Name of the company
                  example: "TechCorp Solutions"
                companyLogo:
                  type: string
                  description: Base64 encoded company logo (required for new companies)
                  example: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChAI9jU77zgAAAABJRU5ErkJggg=="
                headOffice:
                  type: string
                  description: Company head office location
                  example: "Bangalore, India"
                studentImage:
                  type: string
                  description: Base64 encoded student image (optional, uses profile image if not provided)
                  example: "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD..."
      responses:
        '200':
          description: Placement post data prepared successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Placement post data prepared successfully"
                  data:
                    type: object
                    properties:
                      student:
                        type: object
                        properties:
                          id:
                            type: string
                            example: "6899cb184c53588ffc98bc1f"
                          name:
                            type: string
                            example: "John Doe"
                          year:
                            type: string
                            example: "second"
                          course:
                            type: string
                            example: "Computer Science"
                          image:
                            type: string
                            example: "data:image/jpeg;base64,..."
                      company:
                        type: object
                        properties:
                          id:
                            type: string
                            example: "64a1b2c3d4e5f6789012346"
                          name:
                            type: string
                            example: "TechCorp Solutions"
                          logo:
                            type: string
                            example: "data:image/png;base64,..."
                          headOffice:
                            type: string
                            example: "Bangalore, India"
                      position:
                        type: string
                        example: "Software Developer"
                      createdAt:
                        type: string
                        format: date-time
                        example: "2024-01-15T10:30:00.000Z"
        '400':
          description: Missing required fields or validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Missing required fields: studentId, position, companyName, headOffice"
        '404':
          description: Student not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Student not found"
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Server error"
                  error:
                    type: string
                    example: "Error details here"

  /api/admitted/students/companies:
    get:
      summary: Get all companies
      tags:
        - Placement
      responses:
        '200':
          description: List of all companies
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        _id:
                          type: string
                          example: "64a1b2c3d4e5f6789012346"
                        companyName:
                          type: string
                          example: "TechCorp Solutions"
                        companyLogo:
                          type: string
                          example: "data:image/png;base64,..."
                        headOffice:
                          type: string
                          example: "Bangalore, India"
        '500':
          description: Server error

  # ===== COMPANY & DOCUMENT MANAGEMENT =====
  
  /api/admitted/students/companies:
    get:
      summary: 10. Get All Companies
      description: Get list of all registered companies
      tags:
        - Placement Workflow
      responses:
        '200':
          description: List of companies
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        _id:
                          type: string
                        companyName:
                          type: string
                        hrEmail:
                          type: string
                        hrContact:
                          type: string
                        location:
                          type: string
                        companyLogo:
                          type: string
        '500':
          description: Server error

  /api/admitted/students/companies/{companyName}:
    get:
      summary: 11. Get Company by Name
      description: Get specific company details by name
      tags:
        - Placement Workflow
      parameters:
        - name: companyName
          in: path
          required: true
          description: Name of the company
          schema:
            type: string
            example: "TechCorp Solutions"
      responses:
        '200':
          description: Company details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      _id:
                        type: string
                      companyName:
                        type: string
                      hrEmail:
                        type: string
                      hrContact:
                        type: string
                      location:
                        type: string
                      companyLogo:
                        type: string
                      industry:
                        type: string
                      website:
                        type: string
        '404':
          description: Company not found
        '500':
          description: Server error

  /api/admitted/students/placement-documents:
    post:
      summary: 12. Upload Placement Documents
      description: Upload offer letter and commitment application for placed students
      tags:
        - Placement Workflow
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - studentId
                - offerLetter
                - commitmentApplication
                - uploadedBy
              properties:
                studentId:
                  type: string
                  description: ID of placed student
                  example: "64a1b2c3d4e5f6789012345"
                offerLetter:
                  type: string
                  description: Base64 encoded offer letter (image/PDF)
                  example: "data:application/pdf;base64,JVBERi0xLjQ..."
                commitmentApplication:
                  type: string
                  description: Base64 encoded commitment application image
                  example: "data:image/jpeg;base64,/9j/4AAQ..."
                uploadedBy:
                  type: string
                  description: Who uploaded the documents
                  example: "admin"
      responses:
        '200':
          description: Documents uploaded successfully
        '400':
          description: Missing fields or student not placed
        '404':
          description: Student not found
        '500':
          description: Server error

  /api/admitted/students/placement-documents/{studentId}:
    get:
      summary: 13. Get Placement Documents
      description: Retrieve placement documents for a specific student
      tags:
        - Placement Workflow
      parameters:
        - name: studentId
          in: path
          required: true
          description: ID of the student
          schema:
            type: string
            example: "64a1b2c3d4e5f6789012345"
      responses:
        '200':
          description: Documents retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      firstName:
                        type: string
                      lastName:
                        type: string
                      offerLetter:
                        type: string
                      commitmentApplication:
                        type: string
                      documentsUploadedBy:
                        type: string
                      documentsUploadedAt:
                        type: string
                        format: date-time
        '404':
          description: Student or documents not found
        '500':
          description: Server error

  # ===== PLACEMENT WORKFLOW APIs =====
  
  /api/admitted/students/interviews/{id}:
    post:
      summary: 1. Create/Schedule Interview
      description: Schedule interview for ready student with company details
      tags:
        - Placement Workflow
      parameters:
        - name: id
          in: path
          required: true
          description: Student ID
          schema:
            type: string
            example: "64a1b2c3d4e5f6789012345"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - companyName
                - hrEmail
                - location
                - jobProfile
                - scheduleDate
              properties:
                companyName:
                  type: string
                  example: "TechCorp Solutions"
                hrEmail:
                  type: string
                  format: email
                  example: "hr@techcorp.com"
                hrContact:
                  type: string
                  description: Optional - HR contact number
                  example: "+91-9876543210"
                location:
                  type: string
                  example: "Bangalore, India"
                jobProfile:
                  type: string
                  example: "Software Developer"
                scheduleDate:
                  type: string
                  format: date-time
                  example: "2024-01-20T10:00:00Z"
      responses:
        '201':
          description: Interview scheduled successfully
        '400':
          description: Missing required fields or student not ready
        '500':
          description: Server error

  /api/admitted/students/update/interviews/{studentId}/{interviewId}:
    patch:
      summary: 2. Update Interview Status
      description: Update interview status (Ongoing/Pending/Reschedule/Selected/Rejected)
      tags:
        - Placement Workflow
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            example: "64a1b2c3d4e5f6789012345"
        - name: interviewId
          in: path
          required: true
          schema:
            type: string
            example: "64a1b2c3d4e5f6789012346"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum: [Scheduled, Rescheduled, Ongoing, Selected, RejectedByStudent, RejectedByCompany]
                  example: "Selected"
                rescheduleDate:
                  type: string
                  format: date-time
                  description: Required if status is Rescheduled
                  example: "2024-01-25T10:00:00Z"
      responses:
        '200':
          description: Interview status updated successfully
        '404':
          description: Student or interview not found
        '500':
          description: Server error

  /api/admitted/students/interviews/{studentId}/{interviewId}/add-round:
    post:
      summary: 3. Add Interview Round
      description: Add multiple rounds to existing interview
      tags:
        - Placement Workflow
      parameters:
        - name: studentId
          in: path
          required: true
          schema:
            type: string
            example: "64a1b2c3d4e5f6789012345"
        - name: interviewId
          in: path
          required: true
          schema:
            type: string
            example: "64a1b2c3d4e5f6789012346"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - date
              properties:
                roundName:
                  type: string
                  example: "Technical Round"
                date:
                  type: string
                  format: date-time
                  example: "2024-01-22T14:00:00Z"
                mode:
                  type: string
                  enum: [Online, Offline, Telephonic]
                  default: Offline
                  example: "Online"
                feedback:
                  type: string
                  example: "Good technical skills"
                result:
                  type: string
                  enum: [Passed, Failed, Pending]
                  default: Pending
                  example: "Passed"
      responses:
        '200':
          description: Interview round added successfully
        '404':
          description: Interview not found
        '500':
          description: Server error

  /api/admitted/students/Ready_Students:
    get:
      summary: 4. Get Ready Students
      description: Get all students ready for placement interviews
      tags:
        - Placement Workflow
      responses:
        '200':
          description: List of ready students
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Ready students fetched successfully"
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        _id:
                          type: string
                        firstName:
                          type: string
                        lastName:
                          type: string
                        course:
                          type: string
                        readinessStatus:
                          type: string
                          example: "Ready"
        '404':
          description: No ready students found
        '500':
          description: Server error

  /api/admitted/students/selected-students:
    get:
      summary: 5. Get Selected Students
      description: Get students selected but not yet placed
      tags:
        - Placement Workflow
      responses:
        '200':
          description: List of selected students
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        _id:
                          type: string
                        name:
                          type: string
                        course:
                          type: string
                        selectedInterviews:
                          type: array
                          description: Interviews with Selected status
        '500':
          description: Server error

  /api/admitted/students/confirm-placement:
    post:
      summary: 6. Confirm Placement
      description: Move selected student to placed status
      tags:
        - Placement Workflow
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - studentId
                - interviewId
              properties:
                studentId:
                  type: string
                  example: "64a1b2c3d4e5f6789012345"
                interviewId:
                  type: string
                  description: ID of the selected interview record
                  example: "64a1b2c3d4e5f6789012346"
                salary:
                  type: number
                  example: 500000
                joiningDate:
                  type: string
                  format: date
                  example: "2024-07-01"
      responses:
        '200':
          description: Student placement confirmed successfully
        '400':
          description: Interview not in selected state
        '404':
          description: Student or interview not found
        '500':
          description: Server error

  /api/admitted/students/placed-students:
    get:
      summary: 7. Get Placed Students
      description: Get all students with confirmed placements
      tags:
        - Placement Workflow
      responses:
        '200':
          description: List of placed students
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        _id:
                          type: string
                        firstName:
                          type: string
                        lastName:
                          type: string
                        course:
                          type: string
                        placedInfo:
                          type: object
                          description: Final placement details
        '500':
          description: Server error

  /api/admitted/students/placement-post:
    post:
      summary: 8. Create Placement Post
      description: Generate placement post from placed students
      tags:
        - Placement Workflow
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - studentId
                - position
                - companyName
                - headOffice
              properties:
                studentId:
                  type: string
                  description: ID of placed student
                  example: "64a1b2c3d4e5f6789012345"
                position:
                  type: string
                  example: "Software Developer"
                companyName:
                  type: string
                  example: "TechCorp Solutions"
                companyLogo:
                  type: string
                  description: Base64 company logo (updates existing company)
                  example: "data:image/png;base64,..."
                headOffice:
                  type: string
                  example: "Bangalore, India"
                studentImage:
                  type: string
                  description: Optional - uses profile image if not provided
                  example: "data:image/jpeg;base64,..."
      responses:
        '200':
          description: Placement post created successfully
        '400':
          description: Missing required fields or student not placed
        '404':
          description: Student not found
        '500':
          description: Server error

  /api/admitted/students/update-job-type:
    patch:
      summary: 9. Update Job Type
      description: Update job type from Internship to Full-Time/PPO
      tags:
        - Placement Workflow
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - studentId
                - interviewId
                - newJobType
              properties:
                studentId:
                  type: string
                  example: "64a1b2c3d4e5f6789012345"
                interviewId:
                  type: string
                  example: "64a1b2c3d4e5f6789012346"
                newJobType:
                  type: string
                  enum: [Internship, Full-Time, PPO]
                  example: "Full-Time"
                newJobProfile:
                  type: string
                  example: "Senior Software Developer"
                internshipEndDate:
                  type: string
                  format: date
                  example: "2024-06-30"
      responses:
        '200':
          description: Job type updated successfully
        '404':
          description: Student or interview not found
        '500':
          description: Server error


  /api/admitted/students/update_technology/{id}:
    put:
      summary: Update student's technology after Level 2A
      description: Updates the 'techno' field of a student only if they have passed Level 2A.
      tags:
        - Admitted Student
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the student
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - techno
              properties:
                techno:
                  type: string
                  example: MERN Stack
      responses:
        '200':
          description: Technology updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Technology updated successfully
                  student:
                    $ref: '#/components/schemas/AdmittedStudent'
        '400':
          description: Missing technology field
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Technology field is required
        '403':
          description: Level 2A not completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Student must complete Level 2A before updating technology
        '404':
          description: Student not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Student not found
        '500':
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Server error
                  error:
                    type: string



  /api/admitted/students/update/profile/{id}:
    patch:
      tags:
        - Admitted Student
      summary: Update student profile image
      description: Upload a base64 image, store it on Cloudinary, and update the student record with the URL.
      parameters:
        - name: id
          in: path
          required: true
          description: Student's ID
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                image:
                  type: string
                  description: Base64 image string (must include prefix like data:image/png;base64,...)
                  example: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA..."
      responses:
        '200':
          description: Successfully updated student image
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Profile image updated successfully
                  student:
                    $ref: '#/components/schemas/AdmittedStudent'
        '400':
          description: Bad Request - Missing or invalid image
        '404':
          description: Student not found
        '500':
          description: Internal Server Error
 
  /api/admitted/students/reschedule/interview/{studentId}/{interviewId}:
    patch:
      tags:
        - Placement
      summary: Reschedule an interview
      description: Reschedules a specific interview for a student and updates its status to "Rescheduled".
      parameters:
        - in: path
          name: studentId
          required: true
          schema:
            type: string
          description: ID of the admitted student
        - in: path
          name: interviewId
          required: true
          schema:
            type: string
          description: ID of the interview record to be rescheduled
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - newDate
              properties:
                newDate:
                  type: string
                  format: date-time
                  example: "2025-08-15T10:00:00.000Z"
      responses:
        "200":
          description: Interview rescheduled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Interview rescheduled successfully.
                  updatedData:
                    type: object
                    description: Updated student document with modified interview record
        "400":
          description: Bad Request - Missing or invalid date
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: New date is required.
        "404":
          description: Student or interview not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Student or interview not found.
        "500":
          description: Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Server error.
                  error:
                    type: string
                    example: Error message details

  /api/admitted/students/count/{studentId}:
    get:
      summary: Count total placement interviews of a student
      tags:
        - Placement
      parameters:
        - in: path
          name: studentId
          required: true
          schema:
            type: string
          description: ID of the student
      responses:
        "200":
          description: Interview count fetched successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  studentId:
                    type: string
                  totalInterviews:
                    type: integer
        "500":
          description: Internal server error
